<div class="container mt-4" data-page-id="carnivals-add-sponsor">
    <div class="row">
        <div class="col-md-12">
            <!-- Page Header -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2 class="h3 mb-1">
                        <i class="bi bi-plus-circle text-primary me-2"></i>
                        Add Sponsor
                    </h2>
                    <p class="text-muted mb-0">
                        Add a sponsor to <%= carnival.title %>
                    </p>
                </div>
                <div>
                    <a href="/carnivals/<%= carnival.id %>/sponsors" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-left me-1"></i>Back to Sponsors
                    </a>
                </div>
            </div>

            <!-- Flash Messages -->
            <%- include('../partials/flash-messages') %>

            <div class="row">
                <!-- Add Existing Sponsor -->
                <div class="col-lg-6 mb-4">
                    <div class="card h-100">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="bi bi-link text-info me-2"></i>
                                Link Existing Sponsor
                            </h5>
                        </div>
                        <div class="card-body">
                            <% if (availableSponsors && availableSponsors.length > 0) { %>
                                <p class="text-muted mb-3">
                                    Select from existing sponsors to link to this carnival:
                                </p>
                                
                                <form method="POST" action="/carnivals/<%= carnival.id %>/sponsors/add">
                                    <div class="mb-3">
                                        <label for="sponsorId" class="form-label">Select Sponsor</label>
                                        <select class="form-select" id="sponsorId" name="sponsorId" required>
                                            <option value="">Choose a sponsor...</option>
                                            <% availableSponsors.forEach(sponsor => { %>
                                                <option value="<%= sponsor.id %>">
                                                    <%= sponsor.sponsorName %>
                                                    <% if (sponsor.location) { %> - <%= sponsor.location %><% } %>
                                                    <% if (sponsor.sponsorshipLevel) { %> (<%= sponsor.sponsorshipLevel %>)<% } %>
                                                </option>
                                            <% }); %>
                                        </select>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-primary">
                                        <i class="bi bi-link me-2"></i>Link Sponsor to Carnival
                                    </button>
                                </form>
                            <% } else { %>
                                <div class="text-center py-4">
                                    <i class="bi bi-exclamation-circle bi-2x text-muted mb-3"></i>
                                    <p class="text-muted mb-0">
                                        No existing sponsors available to link to this carnival.
                                    </p>
                                </div>
                            <% } %>
                        </div>
                    </div>
                </div>

                <!-- Create New Carnival-Specific Sponsor -->
                <div class="col-lg-6 mb-4">
                    <div class="card h-100">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="bi bi-plus text-success me-2"></i>
                                Create Carnival-Specific Sponsor
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="text-muted mb-3">
                                Create a new sponsor that will be specific to this carnival only:
                            </p>
                            
                            <form method="POST" action="/carnivals/<%= carnival.id %>/sponsors/add">
                                <!-- Hidden field to indicate this is a new sponsor creation -->
                                <input type="hidden" name="createNew" value="true">
                                
                                <div class="mb-3">
                                    <label for="sponsorName" class="form-label">Sponsor Name <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="sponsorName" name="sponsorName" required 
                                           placeholder="Enter sponsor name">
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="contactPerson" class="form-label">Contact Person</label>
                                        <input type="text" class="form-control" id="contactPerson" name="contactPerson" 
                                               placeholder="Contact name">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="contactEmail" class="form-label">Contact Email</label>
                                        <input type="email" class="form-control" id="contactEmail" name="contactEmail" 
                                               placeholder="contact@sponsor.com">
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="location" class="form-label">Location</label>
                                        <input type="text" class="form-control" id="location" name="location" 
                                               placeholder="City/Suburb">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="state" class="form-label">State</label>
                                        <select class="form-select" id="state" name="state">
                                            <option value="">Select state...</option>
                                            <% states.forEach(state => { %>
                                                <option value="<%= state %>"><%= state %></option>
                                            <% }) %>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="sponsorshipLevel" class="form-label">Sponsorship Level <span class="text-danger">*</span></label>
                                    <select class="form-select" id="sponsorshipLevel" name="sponsorshipLevel" required>
                                        <option value="">Select level...</option>
                                        <% sponsorshipLevels.forEach(level => { %>
                                            <option value="<%= level %>"><%= level %></option>
                                        <% }) %>
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="website" class="form-label">Website</label>
                                    <input type="url" class="form-control" id="website" name="website" 
                                           placeholder="https://www.sponsor.com">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="description" class="form-label">Description</label>
                                    <textarea class="form-control" id="description" name="description" rows="3" 
                                              placeholder="Brief description of the sponsor"></textarea>
                                </div>
                                
                                <button type="submit" class="btn btn-success">
                                    <i class="bi bi-plus me-2"></i>Create & Link Sponsor
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Help Text -->
            <div class="card bg-light">
                <div class="card-body">
                    <h6 class="card-title">
                        <i class="bi bi-info-circle text-info me-2"></i>
                        About Carnival Sponsors
                    </h6>
                    <div class="row">
                        <div class="col-md-6">
                            <p class="card-text small mb-2">
                                <strong>Linking Existing Sponsors:</strong> 
                                This connects sponsors that are already registered in the system to this carnival. 
                                These sponsors may be linked to other clubs or carnivals as well.
                            </p>
                        </div>
                        <div class="col-md-6">
                            <p class="card-text small mb-0">
                                <strong>Carnival-Specific Sponsors:</strong> 
                                This creates a new sponsor record that will be exclusively linked to this carnival. 
                                Perfect for local businesses or one-time sponsors.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
