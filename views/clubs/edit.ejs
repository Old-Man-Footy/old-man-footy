<!-- Page Header -->
<div class="bg-primary py-4 mb-4" data-page-id="clubs-manage">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h1 class="h2 mb-0">Manage Club Profile</h1>
                <p class="lead mb-0">Update your club's public listing and contact information</p>
            </div>
            <div class="col-lg-4 text-end">
                <a href="/dashboard" class="btn btn-outline-tertiary">
                    <i class="bi bi-arrow-left"></i> Back to Dashboard
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Club Management Form -->
<section class="py-4">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <div class="card shadow-sm">
                    <div class="card-header bg-tertiary">
                        <h5 class="mb-0"><i class="bi bi-gear"></i> Club Profile Settings</h5>
                    </div>
                    <div class="card-body">
                        <form method="POST" action="/clubs/<%= club.id %>/edit" enctype="multipart/form-data">
                            <!-- Basic Information -->
                            <div class="row mb-4">
                                <div class="col-12">
                                    <h6 class="text-primary mb-3"><i class="bi bi-info-circle"></i> Basic Information</h6>
                                    <% if (!user.isPrimaryDelegate) { %>
                                        <div class="alert alert-info">
                                            <i class="bi bi-info-circle"></i>
                                            <strong>Note:</strong> Only primary delegates can edit core club information like name and state. 
                                            Contact your primary delegate or support for changes to these fields.
                                        </div>
                                    <% } %>
                                </div>
                                <div class="col-md-6">
                                    <label for="clubName" class="form-label">Club Name *</label>
                                    <% if (user.isPrimaryDelegate) { %>
                                        <input type="text" class="form-control" id="clubName" name="clubName" 
                                               value="<%= club.clubName %>" required maxlength="100">
                                        <div class="form-text">Official name of the rugby league club</div>
                                    <% } else { %>
                                        <input type="text" class="form-control" id="clubName" value="<%= club.clubName %>" disabled>
                                        <div class="form-text">Contact your primary delegate to change the club name</div>
                                    <% } %>
                                </div>
                                <div class="col-md-6">
                                    <label for="location" class="form-label">Location/Suburb</label>
                                    <input type="text" class="form-control" id="location" name="location" 
                                           placeholder="e.g., Parramatta, Sydney" value="<%= club.location || '' %>"
                                           maxlength="100">
                                    <div class="form-text">Specify your club's home location or suburb</div>
                                </div>
                                <div class="col-md-6">
                                    <label for="state" class="form-label">State *</label>
                                    <% if (user.isPrimaryDelegate) { %>
                                        <select class="form-select" id="state" name="state" required>
                                            <option value="">Select State</option>
                                            <option value="NSW" <%= club.state === 'NSW' ? 'selected' : '' %>>NSW</option>
                                            <option value="QLD" <%= club.state === 'QLD' ? 'selected' : '' %>>QLD</option>
                                            <option value="VIC" <%= club.state === 'VIC' ? 'selected' : '' %>>VIC</option>
                                            <option value="WA" <%= club.state === 'WA' ? 'selected' : '' %>>WA</option>
                                            <option value="SA" <%= club.state === 'SA' ? 'selected' : '' %>>SA</option>
                                            <option value="TAS" <%= club.state === 'TAS' ? 'selected' : '' %>>TAS</option>
                                            <option value="NT" <%= club.state === 'NT' ? 'selected' : '' %>>NT</option>
                                            <option value="ACT" <%= club.state === 'ACT' ? 'selected' : '' %>>ACT</option>
                                        </select>
                                        <div class="form-text">State where the club is based</div>
                                    <% } else { %>
                                        <input type="text" class="form-control" id="state" value="<%= club.state || 'Not specified' %>" disabled>
                                        <div class="form-text">Contact your primary delegate to change the state</div>
                                    <% } %>
                                </div>
                            </div>
                            
                            <div class="row mb-4">
                                <div class="col-12">
                                    <label for="description" class="form-label">Club Description</label>
                                    <textarea class="form-control" id="description" name="description" rows="4"
                                              placeholder="Tell potential players about your club, its history, values, and what makes it special..."
                                              maxlength="1000"><%= club.description || '' %></textarea>
                                    <div class="form-text">This will be shown on your public club profile (max 1000 characters)</div>
                                </div>
                            </div>

                            <!-- Club Logo -->
                            <div class="row mb-4">
                                <div class="col-12">
                                    <%- include('../partials/_imageUploader', { 
                                        fieldName: 'logo',
                                        label: 'Club Logo',
                                        allowedTypes: ['.jpg', '.jpeg', '.png', '.svg'],
                                        maxSize: 10,
                                        multiple: false,
                                        required: false,
                                        helpText: 'Upload your club logo (JPEG, PNG, SVG, max 10MB)',
                                        existingFile: club.logoUrl ? { url: club.logoUrl, name: 'Current Logo' } : null
                                    }) %>
                                </div>
                            </div>

                            <!-- Contact Information -->
                            <div class="row mb-4">
                                <div class="col-12">
                                    <h6 class="text-primary mb-3"><i class="bi bi-telephone"></i> Contact Information</h6>
                                </div>
                                <div class="col-md-6">
                                    <label for="contactPerson" class="form-label">Primary Contact Person</label>
                                    <input type="text" class="form-control" id="contactPerson" name="contactPerson" 
                                           placeholder="e.g., John Smith" value="<%= club.contactPerson || '' %>"
                                           maxlength="100">
                                </div>
                                <div class="col-md-6">
                                    <label for="contactEmail" class="form-label">Contact Email</label>
                                    <input type="email" class="form-control" id="contactEmail" name="contactEmail" 
                                           placeholder="e.g., info@yourclub.com" value="<%= club.contactEmail || '' %>"
                                           maxlength="100">
                                </div>
                            </div>

                            <div class="row mb-4">
                                <div class="col-md-6">
                                    <label for="contactPhone" class="form-label">Contact Phone</label>
                                    <input type="tel" class="form-control" id="contactPhone" name="contactPhone" 
                                           placeholder="e.g., (02) 1234 5678" value="<%= club.contactPhone || '' %>"
                                           maxlength="20">
                                </div>
                            </div>

                            <!-- Online Presence -->
                            <div class="row mb-4">
                                <div class="col-12">
                                    <h6 class="text-primary mb-3"><i class="bi bi-globe"></i> Online Presence</h6>
                                </div>
                                <div class="col-md-6">
                                    <label for="website" class="form-label">Club Website</label>
                                    <input type="url" class="form-control" id="website" name="website" 
                                           placeholder="https://www.yourclub.com" value="<%= club.website || '' %>"
                                           maxlength="200">
                                </div>
                                <div class="col-md-6">
                                    <label for="facebookUrl" class="form-label">Facebook Page</label>
                                    <input type="url" class="form-control" id="facebookUrl" name="facebookUrl" 
                                           placeholder="https://facebook.com/yourclub" value="<%= club.facebookUrl || '' %>"
                                           maxlength="200">
                                </div>
                            </div>

                            <div class="row mb-4">
                                <div class="col-md-6">
                                    <label for="instagramUrl" class="form-label">Instagram Profile</label>
                                    <input type="url" class="form-control" id="instagramUrl" name="instagramUrl" 
                                           placeholder="https://instagram.com/yourclub" value="<%= club.instagramUrl || '' %>"
                                           maxlength="200">
                                </div>
                                <div class="col-md-6">
                                    <label for="twitterUrl" class="form-label">X Profile</label>
                                    <input type="url" class="form-control" id="twitterUrl" name="twitterUrl" 
                                           placeholder="https://x.com/yourclub" value="<%= club.twitterUrl || '' %>"
                                           maxlength="200">
                                    <div class="form-text">Link to your X (formerly Twitter) profile</div>
                                </div>
                            </div>

                            <!-- Visibility Settings -->
                            <div class="row mb-4">
                                <div class="col-12">
                                    <h6 class="text-primary mb-3"><i class="bi bi-eye"></i> Visibility Settings</h6>
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="isPubliclyListed" name="isPubliclyListed" 
                                               <%= club.isPubliclyListed ? 'checked' : '' %>>
                                        <label class="form-check-label" for="isPubliclyListed">
                                            <strong>Make club publicly visible</strong>
                                        </label>
                                        <div class="form-text">
                                            When enabled, your club will appear in public club listings and search results. 
                                            Players looking for a team will be able to find and contact your club.
                                        </div>
                                    </div>
                                    
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="isActive" name="isActive" 
                                               <%= club.isActive ? 'checked' : '' %>>
                                        <label class="form-check-label" for="isActive">
                                            <strong>Club is currently active</strong>
                                        </label>
                                        <div class="form-text">
                                            <strong>Important:</strong> When unchecked, your club will be marked as inactive and removed from public listings. 
                                            Your club will still appear on historical carnival pages but will be clearly marked as inactive.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Form Actions -->
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <button type="submit" class="btn btn-tertiary">
                                    <i class="bi bi-check-circle"></i> Update Club Profile
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <!-- Quick Actions -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-primary">
                        <h5 class="mb-0"><i class="bi bi-lightning"></i> Quick Actions</h5>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <a href="/clubs/<%= club.id %>/alternate-names" class="btn btn-outline-primary">
                                <i class="bi bi-search"></i> Manage Alternate Names
                            </a>
                            <a href="/clubs/<%= club.id %>/sponsors" class="btn btn-outline-primary">
                                <i class="bi bi-award"></i> Manage Sponsors
                            </a>
                            <a href="/clubs/<%= club.id %>/players" class="btn btn-outline-primary">
                                <i class="bi bi-people"></i> Manage Players
                            </a>
                            <% if (club.isPubliclyListed) { %>
                                <a href="/clubs/<%= club.id %>" target="_blank" class="btn btn-outline-tertiary">
                                    <i class="bi bi-eye"></i> View Public Profile
                                </a>
                            <% } %>
                        </div>
                        <hr class="my-3">
                        <small class="text-muted">
                            <strong>Alternate Names:</strong> Add search terms that help players find your club more easily.
                        </small>
                    </div>
                </div>

                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-info text-primary">
                        <h5 class="mb-0"><i class="bi bi-lightbulb"></i> Tips for Success</h5>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled">
                            <li class="mb-2">
                                <i class="bi bi-check-circle text-success me-2"></i>
                                <strong>Complete your description</strong> - Tell players what makes your club special
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-check-circle text-success me-2"></i>
                                <strong>Add contact details</strong> - Make it easy for interested players to reach you
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-check-circle text-success me-2"></i>
                                <strong>Link social media</strong> - Show your club's activity and community
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-check-circle text-success me-2"></i>
                                <strong>Enable public listing</strong> - Let players find your club in search results
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-check-circle text-success me-2"></i>
                                <strong>Add alternate names</strong> - Include nicknames and abbreviations for better search results
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Current Status -->
                <div class="card shadow-sm">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0"><i class="bi bi-graph-up"></i> Profile Status</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <strong>Club Status:</strong>
                            <% if (club.isActive) { %>
                                <span class="badge bg-primary ms-2">Active</span>
                                <div class="form-text">Your club is currently active and operational</div>
                            <% } else { %>
                                <span class="badge bg-danger ms-2">Inactive</span>
                                <div class="form-text">Your club is marked as inactive and will not appear in public listings</div>
                            <% } %>
                        </div>
                        <div class="mb-3">
                            <strong>Public Listing:</strong>
                            <% if (club.isPubliclyListed) { %>
                                <span class="badge bg-primary ms-2">Active</span>
                                <div class="form-text">Your club is visible to the public</div>
                            <% } else { %>
                                <span class="badge bg-secondary ms-2">Hidden</span>
                                <div class="form-text">Your club is not yet visible to the public</div>
                            <% } %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script type="module" src="/js/club-manage.js"></script>
<%- include('../partials/help-modal.ejs', { modalId: 'help-clubs-manage' }) %>